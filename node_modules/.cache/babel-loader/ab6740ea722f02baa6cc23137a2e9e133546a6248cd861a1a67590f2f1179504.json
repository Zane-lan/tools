{"ast":null,"code":"import { createCommentVNode as _createCommentVNode, createElementVNode as _createElementVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, resolveComponent as _resolveComponent, createBlock as _createBlock } from \"vue\";\nconst _hoisted_1 = {\n  class: \"tree-menu-container\"\n};\nconst _hoisted_2 = [\"value\"];\nconst _hoisted_3 = {\n  class: \"tree-menu\"\n};\nconst _hoisted_4 = [\"onClick\"];\nconst _hoisted_5 = [\"innerHTML\"];\nconst _hoisted_6 = {\n  key: 0,\n  class: \"arrow\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_TreeMenu = _resolveComponent(\"TreeMenu\", true);\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createCommentVNode(\" 搜索框 \"), _createElementVNode(\"input\", {\n    value: $props.searchQuery,\n    onInput: _cache[0] || (_cache[0] = (...args) => $options.onInput && $options.onInput(...args)),\n    placeholder: \"Search...\",\n    class: \"search-input\"\n  }, null, 40 /* PROPS, NEED_HYDRATION */, _hoisted_2), _createCommentVNode(\" 树形菜单 \"), _createElementVNode(\"ul\", _hoisted_3, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($options.filteredMenu, item => {\n    return _openBlock(), _createElementBlock(\"li\", {\n      key: item.name\n    }, [_createElementVNode(\"div\", {\n      onClick: $event => $options.handleItemClick(item),\n      class: \"menu-item\"\n    }, [_createCommentVNode(\" 高亮匹配项 \"), _createElementVNode(\"span\", {\n      innerHTML: $options.highlightMatch(item.name)\n    }, null, 8 /* PROPS */, _hoisted_5), item.children ? (_openBlock(), _createElementBlock(\"span\", _hoisted_6, _toDisplayString(item.isOpen ? '▼' : '▶'), 1 /* TEXT */)) : _createCommentVNode(\"v-if\", true)], 8 /* PROPS */, _hoisted_4), item.children && item.isOpen ? (_openBlock(), _createBlock(_component_TreeMenu, {\n      key: 0,\n      \"menu-data\": item.children,\n      \"search-query\": $props.searchQuery,\n      \"onUpdate:searchQuery\": _cache[1] || (_cache[1] = value => _ctx.$emit('update:searchQuery', value))\n    }, null, 8 /* PROPS */, [\"menu-data\", \"search-query\"])) : _createCommentVNode(\"v-if\", true)]);\n  }), 128 /* KEYED_FRAGMENT */))])]);\n}","map":{"version":3,"names":["class","key","_createElementBlock","_hoisted_1","_createCommentVNode","_createElementVNode","value","$props","searchQuery","onInput","_cache","args","$options","placeholder","_hoisted_2","_hoisted_3","_Fragment","_renderList","filteredMenu","item","name","onClick","$event","handleItemClick","innerHTML","highlightMatch","_hoisted_5","children","_hoisted_6","_toDisplayString","isOpen","_hoisted_4","_createBlock","_component_TreeMenu","_ctx","$emit"],"sources":["/Volumes/data/project/my_web/tools/src/components/TreeMenu.vue"],"sourcesContent":["<template>\n    <div class=\"tree-menu-container\">\n        <!-- 搜索框 -->\n        <input\n                :value=\"searchQuery\"\n        @input=\"onInput\" \n        placeholder=\"Search...\"\n        class=\"search-input\"\n        />\n        <!-- 树形菜单 -->\n        <ul class=\"tree-menu\">\n            <li v-for=\"item in filteredMenu\" :key=\"item.name\">\n                <div @click=\"handleItemClick(item)\" class=\"menu-item\">\n                    <!-- 高亮匹配项 -->\n                    <span v-html=\"highlightMatch(item.name)\"></span>\n                    <span v-if=\"item.children\" class=\"arrow\">\n            {{ item.isOpen ? '▼' : '▶' }}\n          </span>\n                </div>\n                <TreeMenu\n                        v-if=\"item.children && item.isOpen\"\n                        :menu-data=\"item.children\"\n                        :search-query=\"searchQuery\"\n                        @update:searchQuery=\"(value) => $emit('update:searchQuery', value)\"\n                />\n            </li>\n        </ul>\n    </div>\n</template>\n\n<script>\nexport default {\n    name: 'TreeMenu',\n    props: {\n        menuData: {\n            type: Array,\n            required: true,\n        },\n        searchQuery: {\n            type: String,\n            default: '',\n        },\n    },\n    computed: {\n        // 过滤菜单项\n        filteredMenu() {\n            const query = this.searchQuery.toLowerCase();\n            if (!query) return this.menuData;\n\n            const filterItems = (items) => {\n                return items\n                        .map((item) => {\n                            // 复制对象以避免修改原始数据\n                            const newItem = { ...item };\n                            if (newItem.children) {\n                                newItem.children = filterItems(newItem.children);\n                            }\n                            return newItem;\n                        })\n                        .filter((item) => {\n                            // 保留匹配项或其子项匹配的菜单项\n                            return (\n                                    item.name.toLowerCase().includes(query) ||\n                                    (item.children && item.children.length > 0)\n                            );\n                        });\n            };\n\n            return filterItems(this.menuData);\n        },\n    },\n    methods: {\n        handleItemClick(item) {\n            if (item.children) {\n                item.isOpen = !item.isOpen;\n            } else {\n                this.$router.push(item.path);\n            }\n        },\n        // 高亮匹配的关键字\n        highlightMatch(text) {\n            const query = this.searchQuery.toLowerCase();\n            if (!query) return text;\n\n            const regex = new RegExp(`(${query})`, 'gi');\n            return text.replace(regex, '<span class=\"highlight\">$1</span>');\n        },\n        // 输入事件处理\n        onInput(event) {\n            this.$emit('update:searchQuery', event.target.value);\n        },\n    },\n};\n</script>\n\n<style>\n.tree-menu-container {\n    width: 100%;\n}\n\n.search-input {\n    width: 100%;\n    padding: 8px;\n    margin-bottom: 10px;\n    border: 1px solid #ddd;\n    border-radius: 4px;\n    font-size: 14px;\n}\n\n.tree-menu {\n    list-style-type: none;\n    padding-left: 20px;\n}\n\n.menu-item {\n    padding: 8px;\n    cursor: pointer;\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n}\n\n.menu-item:hover {\n    background-color: #f0f0f0;\n}\n\n.arrow {\n    font-size: 12px;\n}\n\n.highlight {\n    background-color: yellow;\n    font-weight: bold;\n}\n</style>\n"],"mappings":";;EACSA,KAAK,EAAC;AAAqB;mBADpC;;EAUYA,KAAK,EAAC;AAAW;mBAV7B;mBAAA;;EAAAC,GAAA;EAe+CD,KAAK,EAAC;;;;uBAdjDE,mBAAA,CA0BM,OA1BNC,UA0BM,GAzBFC,mBAAA,SAAY,EACZC,mBAAA,CAKE;IAJOC,KAAK,EAAEC,MAAA,CAAAC,WAAW;IAC1BC,OAAK,EAAAC,MAAA,QAAAA,MAAA,UAAAC,IAAA,KAAEC,QAAA,CAAAH,OAAA,IAAAG,QAAA,CAAAH,OAAA,IAAAE,IAAA,CAAO;IACfE,WAAW,EAAC,WAAW;IACvBb,KAAK,EAAC;2CAPdc,UAAA,GASQV,mBAAA,UAAa,EACbC,mBAAA,CAgBK,MAhBLU,UAgBK,I,kBAfDb,mBAAA,CAcKc,SAAA,QAzBjBC,WAAA,CAW+BL,QAAA,CAAAM,YAAY,EAApBC,IAAI;yBAAfjB,mBAAA,CAcK;MAd6BD,GAAG,EAAEkB,IAAI,CAACC;QACxCf,mBAAA,CAMM;MANAgB,OAAK,EAAAC,MAAA,IAAEV,QAAA,CAAAW,eAAe,CAACJ,IAAI;MAAGnB,KAAK,EAAC;QACtCI,mBAAA,WAAc,EACdC,mBAAA,CAAgD;MAA1CmB,SAAkC,EAA1BZ,QAAA,CAAAa,cAAc,CAACN,IAAI,CAACC,IAAI;4BAd1DM,UAAA,GAegCP,IAAI,CAACQ,QAAQ,I,cAAzBzB,mBAAA,CAEH,QAFG0B,UAEH,EAAAC,gBAAA,CADFV,IAAI,CAACW,MAAM,gCAhB1B1B,mBAAA,e,iBAAA2B,UAAA,GAoB8BZ,IAAI,CAACQ,QAAQ,IAAIR,IAAI,CAACW,MAAM,I,cAD1CE,YAAA,CAKEC,mBAAA;MAxBlBhC,GAAA;MAqByB,WAAS,EAAEkB,IAAI,CAACQ,QAAQ;MACxB,cAAY,EAAEpB,MAAA,CAAAC,WAAW;MACzB,sBAAkB,EAAAE,MAAA,QAAAA,MAAA,MAAGJ,KAAK,IAAK4B,IAAA,CAAAC,KAAK,uBAAuB7B,KAAK;8DAvBzFF,mBAAA,e","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}